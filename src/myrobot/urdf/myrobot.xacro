<?xml version="1.0"?>
<robot name="myrobot" xmlns:xacro="http://ros.org/wiki/xacro">

  <link name="world"/>

  <joint name="world_joint" type="fixed">
    <parent link="world"/>
    <child link="base_link"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <link name="base_link">
    <inertial>
      <origin xyz="0 0 0.09" rpy="0 0 0"/>
      <mass value="1.0"/> <inertia ixx="0.1" iyy="0.1" izz="0.1" ixy="0" ixz="0" iyz="0"/>
    </inertial>
    <visual>
      <geometry><mesh filename="package://myrobot/meshes/base_link.STL"/></geometry>
      <material name="red"><color rgba="1.0 0.0 0.0 1.0"/></material>
    </visual>
    </link>

  <joint name="J1" type="revolute">
    <origin xyz="0 0 0.215" rpy="0 0 0"/>
    <parent link="base_link"/>
    <child link="L1"/>
    <axis xyz="0 0 1"/>
    <limit lower="-3.14" upper="3.14" effort="1000" velocity="15.0"/>
  </joint>

  <link name="L1">
    <inertial>
      <origin xyz="0.12 0 0.07" rpy="0 0 0"/>
      <mass value="0.1"/>
      <inertia ixx="0.01" iyy="0.01" izz="0.01" ixy="0" ixz="0" iyz="0"/>
    </inertial>
    <visual>
      <geometry><mesh filename="package://myrobot/meshes/L1.STL"/></geometry>
      <material name="yellow"><color rgba="1.0 1.0 0.0 1.0"/></material>
    </visual>
  </link>

  <joint name="J2" type="revolute">
    <origin xyz="0.25 0 0.12" rpy="0 0 0"/>
    <parent link="L1"/>
    <child link="L2"/>
    <axis xyz="0 0 1"/>
    <limit lower="-3.14" upper="3.14" effort="1000" velocity="15.0"/>
  </joint>

  <link name="L2">
    <inertial>
      <origin xyz="0.12 0 0.07" rpy="0 0 0"/>
      <mass value="0.1"/>
      <inertia ixx="0.01" iyy="0.01" izz="0.01" ixy="0" ixz="0" iyz="0"/>
    </inertial>
    <visual>
      <geometry><mesh filename="package://myrobot/meshes/L2.STL"/></geometry>
      <material name="cyan"><color rgba="0.0 1.0 1.0 1.0"/></material>
    </visual>
  </link>

  <joint name="J3" type="prismatic">
    <origin xyz="0.275 0 0.0" rpy="0 0 0"/> 
    <parent link="L2"/>
    <child link="L3"/>
    <axis xyz="0 0 -1"/>
    <limit lower="0" upper="0.12" effort="500" velocity="20.0"/>
  </joint>

  <link name="L3">
    <inertial>
      <origin xyz="0 0 0.05" rpy="0 0 0"/>
      <mass value="0.1"/>
      <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0" ixz="0" iyz="0"/>
    </inertial>
    <visual>
      <geometry><mesh filename="package://myrobot/meshes/L3.STL"/></geometry>
      <material name="white"><color rgba="1.0 1.0 1.0 1.0"/></material>
    </visual>
  </link>

  <joint name="ee_fixed_joint" type="fixed">
    <parent link="L3"/>
    <child link="ee_marker"/>
    <origin xyz="0 0 -0.08" rpy="0 0 0"/> 
  </joint>

  <link name="ee_marker">
    <inertial> 
      <mass value="0.001"/>
      <inertia ixx="0.0001" iyy="0.0001" izz="0.0001" ixy="0" ixz="0" iyz="0"/>
    </inertial>
    <visual>
      <geometry><sphere radius="0.02"/></geometry>
      <material name="red"><color rgba="1.0 0.0 0.0 1.0"/></material>
    </visual>
  </link>

  <ros2_control name="GazeboSystem" type="system">
    <hardware>
      <plugin>gazebo_ros2_control/GazeboSystem</plugin> 
    </hardware>
    <joint name="J1">
      <command_interface name="position"/>
      <state_interface name="position"/>
    </joint>
    <joint name="J2">
      <command_interface name="position"/>
      <state_interface name="position"/>
    </joint>
    <joint name="J3">
      <command_interface name="position"/>
      <state_interface name="position"/>
    </joint>
  </ros2_control>

  <gazebo>
    <plugin filename="libgazebo_ros2_control.so" name="gazebo_ros2_control">
      <parameters>$(find myrobot)/config/pid_params.yaml</parameters>
    </plugin>
  </gazebo>

  <gazebo reference="base_link"><gravity>0</gravity><material>Gazebo/Red</material></gazebo>
  <gazebo reference="L1"><gravity>0</gravity><material>Gazebo/Yellow</material></gazebo>
  <gazebo reference="L2"><gravity>0</gravity><material>Gazebo/Cyan</material></gazebo>
  <gazebo reference="L3"><gravity>0</gravity><material>Gazebo/White</material></gazebo>
  <gazebo reference="ee_marker"><gravity>0</gravity><material>Gazebo/Red</material></gazebo>
<gazebo>
</gazebo>
</robot>